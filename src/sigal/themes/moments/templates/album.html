{% from 'description.html' import img_description %}
{% extends "base.html" %}

{% block extra_head %}
  <meta charset="utf-8">
  <link rel="stylesheet" href="{{ theme.url }}/moments.css">
  <script type="text/javascript" src="{{ theme.url }}/moments.js"></script>
  
{% endblock extra_head %}

{% block content %}
  {#
  {% include 'download_zip.html' %}
  {% include 'map.html' %}
  #}

    <div class="container-sub">
        <div class="main-photo-section">
            <!-- Main photo display area -->
            <div class="main-photo-wrapper">
                <img id="mainImage" class="main-photo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=" alt="">
            </div>

            <!-- Photo information display area -->
            <div class="photo-info">
                <div class="left-info">
                    <span id="cameraBrand" class="brand"></span>
					<span id="lensModel" class="detail"></span>
                    <span id="photoDetails" class="detail"></span>
                    <span id="cameraModel" style="display:none"></span>
                </div>
                <div class="right-info">
                    <span id="remark"></span>
					<span id="photoDate"></span>
                </div>
            </div>
        </div>

        <!-- Thumbnail navigation bar -->
        <div class="thumbnail-navigation">
          {% for media in album.medias %}

          {% set details_parts = [] %}
          {% if media.exif.iso %}
            {% set _ = details_parts.append('ISO ' ~ media.exif.iso) %}
          {% endif %}
          {% if media.exif.fstop %}
            {% set fstop_display = media.exif.fstop|int if media.exif.fstop == media.exif.fstop|int else media.exif.fstop %}
            {% set _ = details_parts.append('F' ~ fstop_display) %}
          {% endif %}
          {% if media.exif.focal %}
            {% set _ = details_parts.append(media.exif.focal ~ 'mm') %}
          {% endif %}
          {% if media.exif.exposure %}
            {% set _ = details_parts.append(media.exif.exposure ~ 's') %}
          {% endif %}

          {% if media.exif and media.exif.dateobj %}
            {% set date_display = media.exif.dateobj.strftime('%Y-%m-%d %H:%M:%S') %}
          {% else %}
          {% set date_display = '未知日期' %}
          {% endif %}

          <div class="container-test" style="display: none;">{{ media }}</div>
          <a href="#" class="thumbnail-link active"
              data-src="{{ media.url }}"
              data-details="{{ details_parts | join(' ') if details_parts else '无EXIF信息' }}"
              data-date="{{ date_display }}"
              data-brand="{{ [media.exif.Make, media.exif.Model] | join(" ") }}"
              data-model=""
              data-lens="{{ media.exif.LensModel }}"
              data-remark="{{ media.description }}">
            <img class="thumbnail-image" src="{{ media.thumbnail }}" alt="{{ media.title }}">
          </a>
          {% endfor %}
        </div>
    </div>
    
    <!-- Fullscreen Modal -->
    <div id="fullscreen-overlay" class="fullscreen-overlay">
        <div class="fullscreen-controls">
            <!-- Fullscreen button using SVG for better control -->
            <button id="fullscreen-toggle" class="fullscreen-control-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-fullscreen">
                    <path d="M4 8V4m0 0h4M4 4l5 5"></path>
                    <path d="M20 16v4m0 0h-4M20 20l-5-5"></path>
                    <path d="M4 16v4m0 0h4M4 20l5-5"></path>
                    <path d="M20 8V4m0 0h-4M20 4l-5 5"></path>
                </svg>
            </button>
            <!-- Zoom-in button using SVG (new hollow version) -->
            <button id="zoom-in-button" class="fullscreen-control-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="icon icon-zoom-new">
				  <circle cx="10" cy="10" r="6" fill="none" stroke="currentColor" stroke-width="2"/>
				  <line x1="14.5" y1="14.5" x2="20" y2="20" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				  <line x1="8" y1="10" x2="12" y2="10" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				  <line x1="10" y1="8" x2="10" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
				</svg>
            </button>
            <!-- Close button -->
            <button id="fullscreen-close" class="fullscreen-control-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="icon icon-close">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <img id="fullscreen-image" class="fullscreen-image" src="" alt="全屏照片">
        <!-- Fullscreen navigation buttons -->
        <button id="fullscreenPrev" class="fullscreen-nav-button">&#10094;</button>
        <button id="fullscreenNext" class="fullscreen-nav-button">&#10095;</button>
    </div>


{% endblock %}

{% block extra_footer %}
{% endblock %}
